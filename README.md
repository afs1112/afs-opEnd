

# è®¾å¤‡æ¨¡æ‹Ÿæ“ä½œç«¯ ğŸš€

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)
[![Electron 28](https://img.shields.io/badge/Electron-28-9FEAF9.svg?logo=electron)](https://www.electronjs.org)
[![Vue 3](https://img.shields.io/badge/Vue-3-4FC08D.svg?logo=vuedotjs)](https://vuejs.org)
[![TypeScript Ready](https://img.shields.io/badge/TypeScript-Ready-3178C6.svg?logo=typescript)](https://www.typescriptlang.org)

**åŸºäºElectronå’ŒVue 3çš„è®¾å¤‡æ¨¡æ‹Ÿæ“ä½œç«¯** - æ”¯æŒç»„æ’­ç›‘å¬ã€protobufè§£æã€æ— äººæœºé€šä¿¡åè®®ç­‰åŠŸèƒ½ã€‚

![{7E915174-6BEE-45A4-8E5C-82397882E431}](https://github.com/user-attachments/assets/a7928531-a4bc-4c9b-91df-ff7fc8aa7ebb)


## ä¸»è¦åŠŸèƒ½ ğŸ’¡

è®¾å¤‡æ¨¡æ‹Ÿæ“ä½œç«¯çš„ä¸»è¦åŠŸèƒ½ç‰¹æ€§ï¼š
âœ… **ç»„æ’­ç›‘å¬** - æ”¯æŒUDPç»„æ’­æ•°æ®åŒ…ç›‘å¬  
âœ… **Protobufè§£æ** - æ”¯æŒå¤šç§æ— äººæœºé€šä¿¡åè®®è§£æ  
âœ… **å®æ—¶æ•°æ®æ˜¾ç¤º** - å®æ—¶æ˜¾ç¤ºæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ä¿¡æ¯  
âœ… **æ•°æ®å¯¼å‡º** - æ”¯æŒæ•°æ®å¯¼å‡ºå’Œæ¸…ç©ºåŠŸèƒ½  
âœ… **ç¯å¢ƒé…ç½®** - æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½®ç»„æ’­å‚æ•°  
âœ… **è°ƒè¯•é¢æ¿** - å†…ç½®å¼€å‘è€…å·¥å…·å’Œè°ƒè¯•åŠŸèƒ½

## æ ¸å¿ƒåŠŸèƒ½ âœ¨

### ğŸ›¡ï¸ æ ¸å¿ƒæ¶æ„
- Electron 28 + Vue 3 + Vite + TypeScript 
- å®‰å…¨çš„IPCé€šä¿¡æœºåˆ¶
- åŸç”Ÿæ¨¡å—æ”¯æŒ (SQLite3, UDPç»„æ’­)
- å¤šç¯å¢ƒé…ç½®æ”¯æŒ (å¼€å‘/ç”Ÿäº§)

### ğŸ“¡ ç»„æ’­ç›‘å¬
- UDPç»„æ’­æ•°æ®åŒ…ç›‘å¬
- å®æ—¶æ•°æ®åŒ…è§£æå’Œæ˜¾ç¤º
- æ”¯æŒå¤šç§åè®®æ ¼å¼
- æ•°æ®åŒ…ç»Ÿè®¡å’Œæ—¥å¿—

### ğŸ” Protobufè§£æ
- æ”¯æŒå¤šç§æ— äººæœºé€šä¿¡åè®®
- å®æ—¶protobufæ•°æ®è§£æ
- ç»“æ„åŒ–æ•°æ®æ˜¾ç¤º
- åè®®ç±»å‹è¯†åˆ«

### ğŸ›ï¸ ç”Ÿäº§ä¼˜åŒ–
- Electron-builderé…ç½®:
  - è‡ªåŠ¨æ›´æ–°æ”¯æŒ
  - ä»£ç ç­¾åå‡†å¤‡
  - è·¨å¹³å°æ„å»º (Windows/Mac/Linux)
  - èµ„æºå‹ç¼© (asar)
- æ€§èƒ½ç›‘æ§é’©å­
- å†…å­˜æ³„æ¼æ£€æµ‹

### ğŸ¨ å‰ç«¯ç‰¹æ€§
- ç°ä»£åŒ–UIè®¾è®¡
- å“åº”å¼å¸ƒå±€ç»„ä»¶
- é”™è¯¯è¾¹ç•Œå¤„ç†
- å¯å®šåˆ¶åŒ–æ’ä»¶æ¶æ„
- æ·±è‰²/æµ…è‰²ä¸»é¢˜æ”¯æŒ

## å¿«é€Ÿå¼€å§‹ ğŸš€

### ç³»ç»Ÿè¦æ±‚
- Node.js 18+ (æ¨èLTSç‰ˆæœ¬)
- npm 9+ æˆ– yarn 1.22+
- Python 3.10+ (ç”¨äºnode-gypç¼–è¯‘)
- æ„å»ºå·¥å…·:
  - **Windows**: Visual Studio Build Tools
  - **Mac**: Xcode Command Line Tools
  - **Linux**: build-essential

### å®‰è£…å’Œè¿è¡Œ
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd opEnd

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# å¯åŠ¨åº”ç”¨
npm start
```

## åè®®é…ç½® ğŸ“¡

### ç»„æ’­é…ç½®
åœ¨ `config.env` æ–‡ä»¶ä¸­é…ç½®ç»„æ’­å‚æ•°ï¼š

```ini
# ç»„æ’­é…ç½®
MULTICAST_ADDRESS=239.255.43.21
MULTICAST_PORT=10086
INTERFACE_ADDRESS=0.0.0.0

# åº”ç”¨é…ç½®
NODE_ENV=development
```

### é€šä¿¡åè®®æ ¼å¼
æ•°æ®åŒ…æ ¼å¼ï¼š`0xAA 0x55 + ProtocolID + PackageType + Size + ProtobufData`

- **åŒ…å¤´**: 0xAA 0x55 (å›ºå®š)
- **ProtocolID**: åè®®ID (0æˆ–1ä»£è¡¨ä¸¤ä¸ªé£æœº)
- **PackageType**: åŒ…ç±»å‹
- **Size**: Protobufæ•°æ®é•¿åº¦ (4å­—èŠ‚å°ç«¯åº)
- **ProtobufData**: å®é™…çš„protobufæ•°æ®

### æ”¯æŒçš„åè®®ç±»å‹
- **0x01**: é£è¡ŒçŠ¶æ€ä¿¡æ¯ (UavFlyStatusInfo)
- **0x20**: èˆªçº¿ä¸Šä¼  (UavRouteUpload)
- **0x21**: å®‰å…¨è¾¹ç•Œæ§åˆ¶ (UavSecurityBoundaryControl)
- **0x22**: å®šç‚¹å¯¼èˆª (UavFixedPointNavigation)
- **0x23**: é¶åœºç‚¹é€‰æ‹© (UavRangePointSelect)
- **0x24**: å¯¼èˆªå›å¤ä¿¡æ¯ (UavNavReplyInfo)
- **0x25**: èˆªçº¿ä¸Šä¼ å›å¤ (UavRouteUploadReply)
- **0x26**: å¯¼èˆªæ¨¡å¼è¯·æ±‚ (UavNavModeRequest)
- **0x27**: å®šä½æ¨¡å¼è¯·æ±‚ (UavPositioningModeRequest)
- **0x28**: å›æ”¶èˆªçº¿å‘½ä»¤ (UavRecoveryrouteCmd)
## æµ‹è¯•å’Œè°ƒè¯• ğŸ§ª

### æµ‹è¯•è„šæœ¬
é¡¹ç›®æä¾›äº†å¤šä¸ªæµ‹è¯•è„šæœ¬æ¥éªŒè¯åŠŸèƒ½ï¼š

```bash
# æµ‹è¯•æ–°çš„åè®®æ ¼å¼
node test-new-protocol.js

# æµ‹è¯•ç»„æ’­ç›‘å¬
node test-multicast.js

# æµ‹è¯•protobufæ•°æ®å‘é€
node test-protobuf-multicast.js
```

### è°ƒè¯•é¢æ¿
åœ¨åº”ç”¨è¿è¡Œæ—¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰“å¼€è°ƒè¯•é¢æ¿ï¼š

1. **é”®ç›˜å¿«æ·é”®**: 
   - macOS: `Cmd + Option + I` æˆ– `F12`
   - Windows/Linux: `Ctrl + Shift + I` æˆ– `F12`

2. **èœå•æ **: 
   - ç‚¹å‡» "å¼€å‘" -> "æ‰“å¼€å¼€å‘è€…å·¥å…·"

3. **å¼ºåˆ¶é‡æ–°åŠ è½½**: 
   - ç‚¹å‡» "å¼€å‘" -> "å¼ºåˆ¶é‡æ–°åŠ è½½"

## é¡¹ç›®ç»“æ„ ğŸ—ï¸

```
opEnd/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/	# Electronä¸»è¿›ç¨‹
â”‚   â”‚   â”œâ”€â”€ database/	# SQLite3æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ migrations/	# æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”‚   â””â”€â”€ seeds/	# åˆå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ services/	# æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ multicast.service.ts	# ç»„æ’­ç›‘å¬æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ protobuf-parser.service.ts	# Protobufè§£ææœåŠ¡
â”‚   â”‚   â”œâ”€â”€ main.ts	# ä¸»è¿›ç¨‹å…¥å£
â”‚   â”‚   â””â”€â”€ preload.ts	# é¢„åŠ è½½è„šæœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ protobuf/	# Protobufå®šä¹‰æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ PublicStruct.proto	# å…¬å…±ç»“æ„
â”‚   â”‚   â”œâ”€â”€ UavFlyStatusStruct.proto	# é£è¡ŒçŠ¶æ€åè®®
â”‚   â”‚   â”œâ”€â”€ UavNavMonitorStruct.proto	# å¯¼èˆªç›‘æ§åè®®
â”‚   â”‚   â””â”€â”€ UavFlyMonitorStruct.proto	# é£è¡Œç›‘æ§åè®®
â”‚   â”‚
â”‚   â””â”€â”€ renderer/	# Vue 3æ¸²æŸ“è¿›ç¨‹
â”‚       â”œâ”€â”€ assets/	# é™æ€èµ„æº
â”‚       â”œâ”€â”€ services/	# å‰ç«¯æœåŠ¡
â”‚       â”œâ”€â”€ typings/	# TypeScriptç±»å‹å®šä¹‰
â”‚       â””â”€â”€ views/	# é¡µé¢ç»„ä»¶
â”‚           â””â”€â”€ pages/
â”‚               â””â”€â”€ MulticastPage.vue	# ç»„æ’­ç›‘å¬é¡µé¢
â”‚
â”œâ”€â”€ config.env	# ç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ electron-builder.json	# æ‰“åŒ…é…ç½®
â””â”€â”€ package.json	# é¡¹ç›®é…ç½®
```

## Database Operations Example ğŸ’¾

### 1. Create Migration

```typescript
// src/main/database/migrations/20240520_create_users.ts
import type { Database } from 'sqlite3';

export const up = (db: Database) => {
  db.exec(` CREATE TABLE IF NOT EXISTS users (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      name TEXT NOT NULL CHECK(length(name) > 2),
      email TEXT UNIQUE NOT NULL,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP
    );
    
    CREATE INDEX idx_users_email ON users(email); `);
};

export const down = (db: Database) => {
  db.exec('DROP TABLE IF EXISTS users');
};
```

### 2. Run Migrations

```bash
yarn postinstall
```
### 3. Type-safe CRUD Operations

```typescript

// src/renderer/services/userService.ts
interface User {
  id?: number;
  name: string;
  email: string;
}

export const UserService = {
  async create(user: User) {
    const { lastID } = await db.run(
      'INSERT INTO users (name, email) VALUES (?, ?)',
      [user.name, user.email]
    );
    return this.getById(lastID);
  },

  async getById(id: number) {
    return db.get<User>(
      'SELECT * FROM users WHERE id = ?',
      [id]
    );
  }
}
```

## Advanced Configuration âš™ï¸

### Environment Variables

Create  `.env`  file:

```ini
# Main Process
VITE_APP_NAME="My Electron App"
VITE_APP_VERSION=1.0.0

# Database
VITE_DB_NAME=application.db
VITE_DB_ENCRYPTION_KEY=your-secure-key
```

### Build Targets

```bash
# Build for current platform
yarn build

# Build Windows x64
yarn build:win

# Build Linux AppImage
yarn build:linux

# Build macOS universal
yarn build:mac
```

## Best Practices Checklist âœ…

1.  **IPC Security**
    
    -   Validate all IPC arguments with Zod
        
    -   Use dedicated channels for sensitive operations
        
    -   Implement rate limiting for high-frequency events
        
2.  **Database Optimization**
    
    -   Use transactions for bulk operations
        
    -   Enable WAL mode for concurrent access
        
    -   Regular vacuum operations for space reclaim
        
3.  **Performance**
    
    -   Freeze Vue non-reactive data
        
    -   Use Web Workers for CPU-heavy tasks
        
    -   Implement main/renderer process monitoring
        
4.  **Packaging**
    
    -   Sign binaries for all target platforms
        
    -   Use environment-specific builds
        
    -   Obfuscate sensitive code areas

## License ğŸ“„

Distributed under the MIT License. See  `LICENSE`  for more information.
